import json
import sys
import pandas as pd
import numpy as np

# определяем DataFrame Мировой
data = pd.DataFrame({'year': [1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020],
                     'generate': [8.26192344363636, 9.20460066059596, 12.0178164697778, 15.921260267805, 21.2161740066094, 31.420434564131, 38.3904519471421, 52.3307819867071, 62.9113953016839, 85.1161924282732, 104.083879757882, 132.859216030029, 170.682620580279, 220.600045153997, 276.020526299077, 346.465021938078, 440.385091980306, 530.55442135112, 635.49205101167, 705.805860788812, 831.42968828187, 962.227395409379, 1140.31094904253, 1269.52053571083, 1418.17004626655, 1591.2135122193],
                     'total':[13375.2439634053, 13789.2495277064, 14120.5171345097, 14502.9192434368, 14917.7637553936, 15555.5482906317, 15788.8606107222, 16345.4843195876, 16924.0184060025, 17726.7475122076, 18454.1188104507, 19155.2911176488, 20045.9829957051, 20421.6373537822, 20264.8910596484, 21570.6888619834, 22256.9952443638, 22806.2764799403, 23435.2382123808, 24031.7070496167, 24270.5009409496, 24915.1871081891, 25623.8922507836, 26659.1362380925, 27000.9508509267, 26823.2483500223],
                     'costs':[0.196, 0.178, 0.157, 0.139, 0.134, 0.142, 0.126, 0.119, 0.106, 0.111, 0.104, 0.105, 0.098, 0.088, 0.087, 0.086, 0.083, 0.083, 0.082, 0.076, 0.069, 0.066, 0.064, 0.058, 0.053, 0.05]})


file_name = 'Prognose_Request1.json'
data_json = {}
data_json['dataset'] = {}
data_json['dataset']['date'] = "20.10.2023"
data_json['dataset']['start'] = 1995
data_json['dataset']['end'] = 2050
data_json['dataset']['records'] = []

i = 0
for key in data['year'].values:
    # print(key)
    data_json['dataset']['records'].append({'date': int(key), 'fields':[
        {'name': "Generation wind world",
        "datatype": "double",
        'value':str(data['generate'][i]),
        'total':str(data['total'][i]),
        'costs':str(data['costs'][i])
        }]})
    i += 1

with open('Prognose_Request1.json', 'w') as json_file:
    json.dump(data_json, json_file, ensure_ascii=False, indent=4)
